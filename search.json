[
  {
    "objectID": "6-mass-shoot.html",
    "href": "6-mass-shoot.html",
    "title": "6  美国大规模枪击案",
    "section": "",
    "text": "变量说明。"
  },
  {
    "objectID": "6-mass-shoot.html#描述性分析",
    "href": "6-mass-shoot.html#描述性分析",
    "title": "6  美国大规模枪击案",
    "section": "6.2 描述性分析",
    "text": "6.2 描述性分析\n\nshoot <- read_csv(\"data/Mass shooting/Mass Shootings Dataset Ver 3.csv\")\nshoot <- shoot %>% \n  rename(ID = `S#`, Open_Close = `Open/Close Location`,\n         Total = `Total victims`,\n         Mental = `Mental Health Issues`)\nshoot$Date <- as.Date(shoot$Date, \"%m/%d/%Y\")\nshoot$year <- year(shoot$Date)\nshoot <- shoot %>% \n  filter(year != 1966)\n\nglimpse(shoot)\n\nRows: 318\nColumns: 22\n$ ID                 <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, …\n$ Title              <chr> \"Las Vegas Strip mass shooting\", \"San Francisco UPS…\n$ Location           <chr> \"Las Vegas, NV\", \"San Francisco, CA\", \"Tunkhannock,…\n$ Date               <date> 2017-10-01, 2017-06-14, 2017-06-07, 2017-06-05, 20…\n$ `Incident Area`    <chr> NA, \"UPS facility\", \"Weis grocery\", \"manufacturer F…\n$ Open_Close         <chr> NA, \"Close\", \"Close\", \"Close\", \"Close\", \"Open\", \"Cl…\n$ Target             <chr> NA, \"coworkers\", \"coworkers\", \"coworkers\", \"coworke…\n$ Cause              <chr> NA, NA, \"terrorism\", \"unemployement\", NA, \"racism\",…\n$ Summary            <chr> NA, \"Jimmy Lam, 38, fatally shot three coworkers an…\n$ Fatalities         <dbl> 58, 3, 3, 5, 3, 3, 5, 5, 3, 5, 49, 0, 1, 0, 0, 1, 4…\n$ Injured            <dbl> 527, 2, 0, 0, 0, 0, 6, 0, 3, 11, 53, 4, 4, 6, 4, 4,…\n$ Total              <dbl> 585, 5, 3, 5, 3, 3, 11, 5, 6, 16, 102, 4, 5, 6, 4, …\n$ `Policeman Killed` <dbl> NA, 0, NA, NA, 1, NA, NA, NA, 3, 5, 0, 0, 0, 0, 0, …\n$ Age                <dbl> NA, 38, 24, 45, 43, 39, 26, 20, NA, 25, 29, 0, NA, …\n$ `Employeed (Y/N)`  <dbl> NA, 1, 1, 1, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ `Employed at`      <chr> NA, NA, \"Weis grocery\", \"manufacturer Fiamma Inc.\",…\n$ Mental             <chr> \"Unclear\", \"Yes\", \"Unclear\", \"Unclear\", \"Yes\", \"Unc…\n$ Race               <chr> \"White\", \"Asian\", \"White\", NA, \"White\", \"Black\", \"L…\n$ Gender             <chr> \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"…\n$ Latitude           <dbl> 36.18127, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 3…\n$ Longitude          <dbl> -115.13413, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ year               <dbl> 2017, 2017, 2017, 2017, 2017, 2017, 2017, 2016, 201…\n\n\n\n6.2.1 枪击案中伤亡人数\n\n# 封装条形图作图函数\nfun_bar1 <- function(data, xlab, ylab, xname, yname){\n  data %>% \n    group_by({{xlab}}) %>% \n    summarise(count = sum({{ylab}})) %>% \n    ggplot(aes(x = reorder(year, -count),\n               y = count)) +\n      geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n      labs(x = xname, y = yname) +\n      theme_bw() +\n      theme(axis.text.x = element_text(angle = 90, vjust = 0.5))\n}\n\np1 <- fun_bar1(shoot, year, Total, \" \", \"受害人数\") +\n  geom_text(aes(label = count), size = 2, angle = 45, vjust = 0.5)\n\np2 <- fun_bar1(shoot, year, Injured, \" \", \"受伤人数\")+\n  geom_text(aes(label = count), size = 2, angle = 45, vjust = 0.5)\n\np3 <- fun_bar1(shoot, year, Fatalities, \" \", \"死亡人数\")+\n  geom_text(aes(label = count), size = 2, angle = 45, vjust = 0.5)\n\nshoot %>% \n  select(year, Injured, Fatalities) %>% \n  pivot_longer(-year,\n               names_to = \"Types\",\n               values_to = \"Values\") %>% \n  ggplot(aes(x = year,  y = Values, fill = Types)) +\n    geom_col() +\n    coord_flip() +\n    theme_bw() \n\n\n\np1/p2/p3\n\n\n\n\n\n整体而言，总伤亡人数呈现增长趋势。\n2015-2017年间，伤亡人数突然增多。\n受害人数2017年最多，1971年最少。\n除2017年外，其余年份受伤和死亡任务相对平衡\n\n\n\n6.2.2 绘制枪击案频率、伤亡总人数和平均伤亡人数（月为单位）\n\n# 提取月份数据\nshoot$month <- month(shoot$Date)\n\n# 每月枪击频率\np4 <- month_freq <- shoot %>% \n  group_by(month) %>% \n  summarise(freq = n()) %>% \n  ggplot(aes(x = reorder(month, freq), y = freq)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = freq), hjust = -0.1, size = 2) +\n    labs(x = \" \", y = \"月均枪击事件数\") +\n    coord_flip() +\n    theme_bw()\n\n# 月伤亡总人数\np5 <- month_total <- shoot %>% \n  group_by(month) %>% \n  summarise(total = sum(Total))%>% \n  ggplot(aes(x = reorder(month, total), y = total)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = total), hjust = -0.1, size = 2) +\n    labs(x = \" \", y = \"月伤亡总人数\") +\n    coord_flip() +\n    theme_bw()\n\n# 月均伤亡人数\np6 <- month_meantotal <- shoot %>% \n  group_by(month) %>% \n  summarise(mean = mean(Total)) %>% \n  ggplot(aes(x = reorder(month, mean), y = mean)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = round(mean,2)), hjust = -0.1, size = 2) +\n    labs(x = \" \", y = \"月均伤亡人数\") +\n    coord_flip() +\n    theme_bw()\np4/p5/p6 \n\n\n\n\n绘制枪击案频率、伤亡总人数和平均伤亡人数（月为单位）\n\n\n\n\n\n十月份至少发生过一起大型枪击案\n\n\n\n6.2.3 枪手与种族之间的关系\n\ntable(shoot$Race)\n\n\n                                              Asian \n                                                  6 \n                                     Asian American \n                                                 11 \n                     Asian American/Some other race \n                                                  1 \n                                              black \n                                                  3 \n                                              Black \n                                                  4 \n                 Black American or African American \n                                                 76 \n         Black American or African American/Unknown \n                                                  1 \n                                             Latino \n                                                  5 \n                   Native American or Alaska Native \n                                                  3 \n                                              Other \n                                                  2 \n                                    Some other race \n                                                 20 \n                                  Two or more races \n                                                  2 \n                                            Unknown \n                                                 42 \n                                              white \n                                                 12 \n                                              White \n                                                  7 \n                White American or European American \n                                                120 \nWhite American or European American/Some other Race \n                                                  1 \n\n# 将所有重复的数据重塑为统一\nshoot <- within(shoot,{ \n  Race_new <- \" \"\n  Race_new[Race == \"Black\"|\n             Race == \"black\"|\n             Race == \"Black American or African American\"|\n             Race == \"Black American or African American/Unknown\"] <- \"Black\"\n  Race_new[Race == \"White\"|Race == \"white\"|\n             Race == \"White American or European American\"|\n             Race == \"White American or European American/Some other Race \"] <- \"White\"\n  Race_new[Race == \"unclear\"|\n             Race == \"\"|\n             Race == \"Unknown\"] <- \"Unknow\"\n  Race_new[Race == \"Asian\"|\n             Race == \"Asian American/Some other race\"|\n             Race == \"Asian American\"] <- \"Asian\"\n  Race_new[Race == \"Latino\"|Race == \"Other\"|\n             Race == \"Native American or Alaska Native\"|\n             Race == \"Native American\"|\n             Race == \"Some other race\"|\n             Race == \"Two or more races\"] <- \"Other\"\n})\n\n# 统计不同Race_new的个数\nshoot$Race_new[is.na(shoot$Race_new)] <-  \"Unknow\"\np7 <- shoot %>% \n  group_by(Race_new) %>% \n  summarise(freq = n()) %>% \n  ggplot(aes(x = reorder(Race_new, freq), y = freq)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = round(freq, 2)), hjust = 0.7, size = 3) +\n    labs(x = \"种族\", y = \"频数\") +\n    coord_flip() +\n    theme_bw()\np8 <- shoot %>% \n  group_by(Race_new) %>% \n  summarise(freq = n()) %>% \n  ggplot(aes(x = Race_new, y = freq, fill = Race_new)) +\n    geom_bar(stat = \"identity\", width = 1) +\n    labs(x = \"种族\", y = \"频数\") +\n    coord_polar(theta = \"y\") + # 将角度映射到y轴\n    theme_bw() +\n    guides(fill = guide_legend(title = NULL))\np7|p8\n\n\n\n\n枪手与种族之间的关系\n\n\n\n\n\n枪手中白种人最多，黑种人次之，亚洲人最少。\n\n\n\n6.2.4 杀手性别和精神状况\n\n# 性别情况\ntable(shoot$Gender)\n\n\n     Female           M         M/F        Male Male/Female     Unknown \n          5          17           1         270           4          21 \n\n# 对数据进行重塑统一\nshoot$Gender[shoot$Gender == \"M\"] <- \"Male\"\nshoot$Gender[shoot$Gender == \"M/F\"] <- \"Male/Female\"\n\np9 <- shoot %>% \n  group_by(Gender) %>% \n  summarise(count = n()) %>% \n  ggplot(aes(x = reorder(Gender, count), y = count)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = count), hjust = 0.7, size = 3) +\n    labs(x = \"性别\", y = \" \") +\n    coord_flip() +\n    theme_bw()\n\n# 精神情况\ntable(shoot$Mental)\n\n\n     No Unclear unknown Unknown     Yes \n     90      13       1     110     104 \n\nshoot$Mental[shoot$Mental == \"Unclear\"|\n               shoot$Mental == \"Unknown\"|\n               shoot$Mental == \"unknown\"] <- \"Unknown\"\n\np10 <- shoot %>% \n  group_by(Mental) %>% \n  summarise(count = n()) %>% \n  ggplot(aes(x = reorder(Mental, count), y = count)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_text(aes(label = count), hjust = 0.7, size = 3) +\n    labs(x = \"是否有精神问题\", y = \"频数\") +\n    coord_flip() +\n    theme_bw()\n\np9/p10\n\n\n\n\n杀手性别和精神状况\n\n\n\n\n由图@ref(fig:gender-mental)可知：\n\n枪手中男性占绝大多数。\n并不是每个枪手都有精神问题，相反有精神问题的与没有精神问题的枪手数量并未拉开差距。\n\n\n\n6.2.5 伤亡水平和不同伤亡水平伤亡人数\n\n# 按照伤亡人数确定伤亡水平\nshoot <- within(shoot,{\n  level <- \"\"\n  level[Total < 5] <- \"<5\"\n  level[Total>=5] <- \"5-10\"\n  level[Total>10] <- \">10\"\n})\n\np11 <- shoot %>% \n  group_by(level) %>% \n  summarise(count = sum(Total)) %>% \n   ggplot(aes(x = reorder(level, count), y = count)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    #geom_label(aes(label = level), hjust = 0.7) +\n    labs(x = \"伤亡水平\", y = \"伤亡人数\") +\n    coord_flip() +\n    theme_bw()\n\np12 <- shoot %>% \n  group_by(level) %>% \n  summarise(count = n()) %>% \n   ggplot(aes(x = reorder(level, count), y = count)) +\n    geom_bar(stat = \"identity\", fill = \"#63B8FF\") +\n    geom_label(aes(label = count), hjust = 0.7) +\n    labs(x = \"伤亡水平\", y = \"频数\") +\n    coord_flip() +\n    theme_bw()\np12/p11\n\n\n\n\n伤亡水平和不同伤亡水平伤亡人数\n\n\n\n\n由图@ref(fig:casualties-level)可知：\n\n大部分枪击事件为伤亡人数5-10之间的小规模枪击事件。\n伤亡水平大于10的案件中总伤亡人数远多于小伤亡水平的枪击案件。"
  },
  {
    "objectID": "6-mass-shoot.html#枪击发生地的可视化地图",
    "href": "6-mass-shoot.html#枪击发生地的可视化地图",
    "title": "6  美国大规模枪击案",
    "section": "6.3 枪击发生地的可视化（地图）",
    "text": "6.3 枪击发生地的可视化（地图）\n\nstates_map <- map_data(\"state\") # 获取美国地图\np13 <- ggplot() +\n  geom_polygon(data= states_map, \n               aes(x = long, y = lat, group = group),\n               color = \"black\", fill = \"white\") +\n  geom_point(data = shoot[shoot$Longitude >= -140, ],\n             aes(x = Longitude, y = Latitude,\n             size = Total, color = Fatalities), \n             alpha = 0.6) +\n  scale_color_gradient(low = \"red\", high = \"black\")\nggplotly(p13)\n\n\n\n\n\n\n枪击案多发生在美国东部地区及西部边境地区。"
  },
  {
    "objectID": "6-mass-shoot.html#枪击案发生地点是否露天",
    "href": "6-mass-shoot.html#枪击案发生地点是否露天",
    "title": "6  美国大规模枪击案",
    "section": "6.4 枪击案发生地点（是否露天）",
    "text": "6.4 枪击案发生地点（是否露天）\n\ntable(shoot$Open_Close)\n\n\n     Close       Open Open+Close Open+CLose \n       193         76         19          1 \n\nshoot$Open_Close[is.na(shoot$Open_Close)] <- \"Unknown\"\nshoot$Open_Close[shoot$Open_Close == \"Open+CLose\"] <- \"Open+Close\"\n\nshoot_Op_Cl <- shoot %>% \n  group_by(Open_Close) %>% \n  summarise(Count = n())\n\nP14 <- ggplot(shoot_Op_Cl, aes(x = reorder(Open_Close, Count), y = Count))+\n  geom_col(fill = \"#63B8FF\") +\n  geom_label(aes(label = Count), hjust = 0.7) +\n  coord_flip()+\n  labs(x = \"Open&Close\", y = \"Count\") +\n  theme_bw()\nP14\n\n\n\n\n\n枪击案件大多发生在室内，室外枪击的数量不到室内数量的一半。"
  },
  {
    "objectID": "6-mass-shoot.html#不同枪击案起因",
    "href": "6-mass-shoot.html#不同枪击案起因",
    "title": "6  美国大规模枪击案",
    "section": "6.5 不同枪击案起因",
    "text": "6.5 不同枪击案起因\n\nshoot_cause <- shoot %>% \n  group_by(Cause) %>% \n  summarise(Count = n())\n\nshoot_cause$Cause[is.na(shoot_cause$Cause)] <- \"Unknown\"\n\n(P15 <- ggplot(shoot_cause, aes(x = reorder(Cause, Count), y = Count))+\n  geom_col(fill = \"#63B8FF\") +\n  geom_text(aes(label = Count), hjust = 0.7, size = 3) +\n  coord_flip()+\n  labs(x = \"Cause\", y = \"Count\") +\n  theme_bw())\n\n\n\n\n\n枪击案的发生大都由于枪手存在精神问题。\n恐怖主义、愤怒和挫折是除精神问题外引发枪击案最多的诱因。"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "kaggle",
    "section": "",
    "text": "Kaggle成立于2010年，是一个进行数据发掘和预测竞赛的在线平台。从公司的角度来讲，可以提供一些数据，进而提出一个实际需要解决的问题；从参赛者的角度来讲，他们将组队参与项目，针对其中一个问题提出解决方案，最终由公司选出的最佳方案可以获得5K-10K美金的奖金。\n除此之外，Kaggle官方每年还会举办一次大规模的竞赛，奖金高达一百万美金，吸引了广大的数据科学爱好者参与其中。从某种角度来讲，大家可以把它理解为一个众包平台，类似国内的猪八戒。但是不同于传统的低层次劳动力需求，Kaggle一直致力于解决业界难题，因此也创造了一种全新的劳动力市场——不再以学历和工作经验作为唯一的人才评判标准，而是着眼于个人技能，为顶尖人才和公司之间搭建了一座桥梁。\n\n\n基于 Pandoc 自定义 block 是一件很有意思的事情，目前不想让模版过于复杂，仅给出几个最常用的例子。如何自定义可以去看谢益辉的新书 https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html。\n\n\n\n\n\n\nNote\n\n\n\nNote that there are five types of callouts, including: note, tip, warning, caution, and important.\n\n\n\n\n\n\n\n\nTip With Caption\n\n\n\nThis is an example of a callout with a caption.\n\n\n\n\n\n\n\n\nExpand To Learn About Collapse\n\n\n\n\n\nThis is an example of a ‘folded’ caution callout that can be expanded by the user. You can use collapse=\"true\" to collapse it by default or collapse=\"false\" to make a collapsible callout that is expanded by default."
  }
]